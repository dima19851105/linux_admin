# Домашнее задание №1
## Условие
    В материалах к занятию есть методичка, в которой описана процедура обновления ядра из репозитория. 
    По данной методичке требуется выполнить необходимые действия. Полученный в ходе выполнения ДЗ 
    Vagrantfile должен быть залит в ваш репозиторий. Для проверки ДЗ необходимо прислать ссылку на него.
    Для выполнения ДЗ со * и ** вам потребуется сборка ядра и модулей из исходников.
    Критерии оценки: Основное ДЗ - в репозитории есть рабочий Vagrantfile с вашим образом.
    ДЗ со звездочкой: Ядро собрано из исходников
    ДЗ с **: В вашем образе нормально работают VirtualBox Shared Folders
    
### Для выполнения задания я установил следующее ПО:
1.  VirtualBox 6.1.2
2.  Vagrant 2.2.7
3.  Packer 1.5.1
4.  Git 2.17.1

***На других версиях ПО не тестировалось.***<br/>
***За основу были взяты части кода из репозитория доступного в личном кабинете [manual_kernel_update](https://github.com/dmitry-lyutenko/manual_kernel_update), с внесением некоторых изменений.***

***

## VagrantFile
Vagrantfile, который был предоставлен в репозитории меня не устроил, так как содержит не совсем мне понятный код,
а также при задании параметров `:net` и `:forwarded_port` выполнение ***vagrant up*** заканчивается ошибкой.
Поэтому решил сделать свой вариант. Источники нашел в открытом доступе [здесь](http://sysadm.pp.ua/linux/sistemy-virtualizacii/vagrantfile.html) и [здесь](https://github.com/erlong15/otus-linux/blob/master/Vagrantfile).

В массиве servers описываются параметры ВМ. Если добавить еще один блок {} с параметрами, vagrant создаст две ВМ.

    servers=[
      {
        :box_name => "centos/7",
        :hostname => "kernel-update",
        :cpus => 10,
        :ram => 4096,
        :hdd_size => "10000",
        :hdd_name => "hdd.vdi"
      }
    ]
    
При создании жесткого диска выполняется проверка, существует ли диск с таким именем или нет. Если не поставить данную проверку ВМ ломается после нескольких перезагрузок из-за ошибки файла диска. Далее создается SATA контроллер и к нему подключается созданный диск. Также пришлось добавить cd-rom для экспериментов с VboxGuestAdditions.

![screen vagrant](https://github.com/parshyn-dima/screens/blob/master/lesson01/screen-vagrant.png)

Далее запускается скрипт, который находится в каталоге scripts. Данный скрипт выполняет установку ядра из репозитория и обновление конфигурации grub2.

    node.vm.provision "shell", path: "./scripts/kernel-update.sh"

Для создания ВМ на основе Vagrantfile необходимо скачать репозиторий. Перейти в каталог Lesson_1 и выполнить команду ***vagrant up***.
В результате вывод команды *uname -r* должен показать следующее

![result vagrant](https://github.com/parshyn-dima/screens/blob/master/lesson01/vagrant-result.png)

***
